{% load crispy_forms_tags %}
{% load static %}
<body>
	<form id="postCreate" method="POST" data-url="{% url 'home:post-create' %}" class="post-create-form dropzone" enctype="multipart/form-data">
		{% csrf_token %}
			<div class="modal-header">
				<h5 class="modal-title" >Create a Post</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
		<div class="modal-body" style="overflow-y: auto; margin:0;">
			<div id="loadingDiv">
				<div class="d-flex justify-content-center mb-1">
					<div class="spinner-border" role="status">
					  <span class="sr-only">Loading...</span>
					</div>
				  </div>
			</div>
			{{ form|crispy }}
			<div class="d-flex justify-content-left">
				<div>
					<button type="button" id="upload-image" class="btn btn-sm mr-auto btn-primary pb-1 fileinput-button">
						<span><i class="fas fa-image"></i></span>
					</button>
				</div>
				<div>
					<p class="pt-1 mx-2 text-muted small">Add up to four images to your post</p>
				</div>
			</div>
			<div id="previews" class="dropzone-previews"></div>
			<div class="fallback">
				{{ image_form }}
			</div>
		</div>
		<div class="modal-footer">
			<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			<button type="submit" id="submit-all" class="btn btn-primary">Post</button>
		</div>
	</form>
	<script src="{% static 'dropzone/dropzone.js' %}"></script>
	<link rel="stylesheet" href="{% static 'dropzone/dropzone.css' %}">
	<style>
		.modal-body {
			overflow-y: auto;
		}
		#divLoading {
			margin: 0px;
			display: none;
			padding: 0px;
			position: absolute;
			right: 0px;
			top: 0px;
			width: 100%;
			height: 100%;
			background-color: rgb(255, 255, 255);
			z-index: 30001;
			opacity: 0.8;
			}
		.spinner-border {
			position: absolute;
			left: 45%;
			top: 50%;
		}
	</style>
	<script>
	Dropzone.autoDiscover = false; 
	var first = new Dropzone(document.body, {
		paramName: "file", // name of input
		url: "{% url 'home:post-create' %}",
		maxFiles: 4,
		addRemoveLinks: true,
		autoProcessQueue : false,
		parallelUploads: 5,
		previewsContainer: "#previews",
		clickable: ".fileinput-button",
		init: function () {
			var submitButton = document.querySelector("#submit-all")
			submitButton.addEventListener("click", function() {
			myDropzone.processQueue();
			});
		}
	})
	</script>
</body>



			




