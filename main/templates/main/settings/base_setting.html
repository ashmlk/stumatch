{% load static %}
<!DOCTYPE html>
<html>
<head>
  <div id="#headerPlaceholder"></div>
  <title>Settings - Corscope</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <link
    href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.6/css/selectize.css">
  <link rel="apple-touch-icon" sizes="57x57" href="{% static 'favicon_folder/apple-icon-57x57.png' %}">
  <link rel="apple-touch-icon" sizes="60x60" href="{% static 'favicon_folder/apple-icon-60x60.png' %}">
  <link rel="apple-touch-icon" sizes="72x72" href="{% static 'favicon_folder/apple-icon-72x72.png' %}">
  <link rel="apple-touch-icon" sizes="76x76" href="{% static 'favicon_folder/apple-icon-76x76.png' %}">
  <link rel="apple-touch-icon" sizes="114x114" href="{% static 'favicon_folder/apple-icon-114x114.png' %}">
  <link rel="apple-touch-icon" sizes="120x120" href="{% static 'favicon_folder/apple-icon-120x120.png' %}">
  <link rel="apple-touch-icon" sizes="144x144" href="{% static 'favicon_folder/apple-icon-144x144.png' %}">
  <link rel="apple-touch-icon" sizes="152x152" href="{% static 'favicon_folder/apple-icon-152x152.png' %}">
  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'favicon_folder/apple-icon-180x180.png' %}">
  <link rel="icon" type="image/png" sizes="192x192"  href="{% static 'favicon_folder/android-icon-192x192.png' %}">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'favicon_folder/favicon-32x32.png' %}">
  <link rel="icon" type="image/png" sizes="96x96" href="{% static 'favicon_folder/favicon-96x96.png' %}">
  <link rel="manifest" href="{% static 'favicon_folder/manifest.json' %}">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="{% static 'favicon_folder/ms-icon-144x144.png' %}">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="{% static 'EasyAutoComplete/easy-autocomplete.min.css' %}">    
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.6/js/standalone/selectize.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/shortcuts/infinite.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
  <script src="{% static 'EasyAutoComplete/jquery.easy-autocomplete.min.js' %}"></script>
  <script src="https://kit.fontawesome.com/d3a3fc2f19.js" crossorigin="anonymous"></script>
  <script src="{% static 'dropzone/dist/dropzone.js' %}"></script>
  <script src="{% static 'js/index.js' %}"></script>
  <script src="{% static 'initial/initial.js' %}"></script>
  <style>
    .mnpglk-active svg {
      color: rgb(126, 192, 243) !important;
    }

    .mnpglk-active span {
      color: rgb(126, 192, 243) !important;
    }

    .side-tab-link-holder svg {
      color: rgb(71, 71, 71);
      margin-top: -2px;
    }

    .menu-bottom-fix {
      min-width: 3rem !important;
    }
    .main-border-l{
      border-left: solid 3px rgba(136, 136, 136, 0.144);
    }
    .side-tab-link-holder .mnpglk:hover{
      border-left: solid 3px rgb(126, 192, 243) !important;
 
    }
    .side-tab-link-holder .mnpglk:hover .col-1{
      margin-left: -3px !important;
    }

    .side-tab-link-holder .mnpglk-active {
      border-left: solid 3px rgb(126, 192, 243) !important; 
    }
    
    .side-tab-link-holder .mnpglk-active .col-1{
      margin-left: -3px !important;
    }

    .info-all .user-num {
      color:rgb(1,119,200);
      font-weight: 400 !important;
    }
    .info-all .badge {
      font-size: 0.7rem !important;
    }
    .t {
      letter-spacing: 1px !important;
    }
    #_pol3 .h6 {
      color: rgb(80, 80, 80) !important;
    }
    #_pol3 .menu-link  {
        border-radius: 8px;
      }
    .profile-header-main-links .pro-link-goto {
        margin-right: 1.2rem !important;
        font-weight: 500 !important;
        font-size: 1rem !important;
        padding-top: 10px !important;
        border-radius: 4px !important;
    }

    .profile-header-main-links .pro-link-goto .pro-link-goto-text{
        margin-bottom: -4px !important;
    }
    .profile-header-main-links .pro-link-goto:hover{
        background-color:rgb(207, 205, 205);
        cursor: pointer;
    }
    .profile-header-main-links .pro-link-goto-active {
        border-bottom:solid 3px rgb(126, 192, 243);
        margin-right: 1.2rem !important;
        font-weight: 500 !important;
        font-size: 1rem !important;
        padding-top: 10px !important;
        border-radius: none !important;
    }
    .profile-header-main-links .pro-link-goto-active:hover{
        cursor: pointer;
    }
    .profile-header-main-links .pro-link-goto-active .pro-link-goto-text {
        color: rgb(126, 192, 243);
        padding-top: 3px !important;
        margin-bottom: -4px !important;
        
    }
    .profile-header-main-links .pro-menu-link{
        background-color: rgb(226,230,234);
    }
    .profile-header-main-links .pro-menu-link:hover{
        cursor: pointer;
        opacity: 0.8;
    }
    .pro-menu-link a{
        color: rgb(17, 17, 17);
        text-decoration: none !important;
    }
    .pro-menu-link a:hover {
        color: rgb(17, 17, 17);
    }  
    .u_pui {
        font-size: 0.9rem ;
    }
    .friends-list .card-friend-name-holder {
        font-weight: 600 !important;
        font-size: 0.85rem !important;
    }
    .u_pctr .card-header strong {
        font-size: 1.1rem;
    }
    .u_pctr .post-title-view strong {
        font-size: 1.1rem;
    }
    .title-setting-all h5 {
        font-size: 1.5rem;
        font-weight: 600;
    }
    .title-setting-all {
      margin-right: -35px !important;
    }
 
    .edit-profile-clickable:hover {
      cursor: pointer;
      opacity: 0.7;
    }
    .edit-pro-all #id_image {
     margin-left: -9999px !important;
    }
    .setting-link-active a{
      color: rgb(126, 192, 243) !important;
    }
    .edit-pro-all .edit-field-label {
      font-weight: 600;
      color: rgba(226, 226, 226, 0.849);
    }
    .messages .text-error {
      color: red;
    }
    .link-to-action .no-style {
      list-style-type: none;
    }
  </style>
</head>
<body class="pb-5" style="background-color: white !important;">
  <div id="#navPlaceholder" class="fixed-top mb-4">{% include 'home/nav.html' %}</div>
  <div class="wrapper">
    <div class="container min-vh-100 pt-5 u_stctr">
        <div class="mt-5 row">
          <div class="p-2 mb-3 d-sm-none"style="width:100%;">
            <div class="dropdown" >
              <a class="w-100 btn btn-light dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Settings
              </a>
            
              <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                <a class="dropdown-item" href="{% url 'main:settings-edit' %}">Account</a>
                <a class="dropdown-item" href="{% url 'main:notifications-settings-all' %}">Notifications</a>
                <a class="dropdown-item" href="{% url 'main:privacy-security' %}">Privacy and Security</a>
                <a class="dropdown-item" href="{% url 'main:settings-blocked' %}">Blocking</a>
                <a class="dropdown-item" href="#">About</a>
              </div>
            </div>
          </div>
        
          
            <div class="d-none d-sm-block col-sm-4 border-right">
                <div class="link-setting all-link">
                    <div class="title-setting-all mb-2">
                        <h5 class="pl-4 ml-3 mb-3">
                            Settings
                        </h5>
                    </div>
                    <div class="link-to-action">
                        <ul class="no-style" style="padding-left: 41px !important;">
                            <li class="{{ account_active }} my-4">
                                <a class="text-dark" href="{% url 'main:settings-edit' %}">
                                    Account
                                </a>
                            </li>
                            <li class="{{ notifcation_active }} my-y">
                                <a class="text-dark" href="{% url 'main:notifications-settings-all' %}">
                                    Notifications
                                </a>
                            </li>
                            <li class="{{ privacy_active }} my-4">
                                <a class="text-dark" href="{% url 'main:privacy-security' %}">
                                    Privacy and Security
                                </a>
                            </li>
                            <li class="{{ blocked_active }} my-4">
                                <a class="text-dark" href="{% url 'main:settings-blocked' %}">
                                    Blocking
                                </a>
                            </li>
                            <li class="my-4">
                                <a class="text-dark" href="#">
                                    About
                                </a>
                            </li>
                          </ul>
                    </div>
                </div>
            </div>
            <div class="col-sm-8 col-12 pl-4">
                {% block content %}{% endblock %}
            </div>
        </div>
    </div>
  </div>
  <div class="modal fade" id="modal-profile">
    <div class="modal-dialog modal-dialog-centered" style="overflow-y: hidden !important;">
      <div class="modal-content"></div>
    </div>
  </div>
  <div id="footer-main-div">
    {% include 'footer_main.html' %}
  </div>
  <script>
    const OG_IMG_SRC = $('.edit-pro-all .img-create-post').attr('src');
    const OG_REMOVE_BTN =  $("#remrevctr button");

      $(document).ready(function () {

          $('#chppbtn').on('click', function () {
            $('.edit-pro-all #id_image').click();
          })

          var reader = new FileReader();
          reader.onload = function (e) {
              $('.edit-pro-all .img-create-post').attr('src', e.target.result);
              var btn = "<button type='button' data-url='{% url 'main:update-image' hid=request.user.get_hashid %}' id='submit-img' class='btn no-border no-outline mr-3 edit-profile-clickable text-primary'>Update</button>";
              var revert_btn = "<button type='button' id='revert-og-img' class='btn no-border no-outline mr-3 edit-profile-clickable text-danger'>Revert</button>";
              $('.edit-pro-all #updtimgbtn').append(btn);
              $('.edit-pro-all #remrevctr').html(revert_btn);
          }

          function readURL(input) {
                  if (input.files && input.files[0]) {
                      reader.readAsDataURL(input.files[0]);
                  }
          }

          $(".edit-pro-all #id_image").change(function(){
              readURL(this);
          });

          $('.edit-pro-all #remrevctr').on('click', function () {
            $('.edit-pro-all .img-create-post').attr('src', OG_IMG_SRC);
            $('.edit-pro-all #remrevctr').html(OG_REMOVE_BTN);
            $('.edit-pro-all #updtimgbtn').empty();
          })

          $(document).on('click','#submit-img', function (e){
              var form = new FormData(this.closest('form'));
              $.ajax({
                url: $(this).attr('data-url'),
                type: "POST",
                data: form,
                cache: false,
                processData: false,
                contentType: false,
                dataType: 'json',
                success: function (data){
                    $('.edit-pro-all .pro-img-ctr').html(data.image_updated);
                },
                error: function(rs, e){
                    console.log(rs.responeText);
                },
            });
          })

          $(document).on("click","#rmvproimg", function (e) {
              e.stopImmediatePropagation();
              var btn = $(this);
              $.ajax({
                  url: btn.attr("data-url"),
                  type: 'get',
                  dataType:'json',
                  data: $(this).closest('form').serialize(),
                  beforeSend: function(){
                      $('#modal-profile').modal('show');
                  },
                  success: function(data){
                      $('#modal-profile .modal-content').html(data.html_form);
                  }
              });
          });

          $('#modal-profile').on("submit",".remove-user-image-form",function (e){
              e.preventDefault();
              e.stopImmediatePropagation();
              var form = new FormData(this);
              $.ajax({
                  url: $(this).attr('data-url'),
                  type: $(this).attr('method'),
                  data: form,
                  cache: false,
                  processData: false,
                  contentType: false,
                  dataType: 'json',
                  success: function(data){
                      $('.edit-pro-all .pro-img-ctr').html(data.image_updated);
                      $('#modal-profile').modal('hide');
                      $('body').removeClass('modal-open');
                      $('.modal-backdrop').remove();                    
                  }
              })
          });

          $('.field-change-btn').on('click', function () {
            var content_id = "id_" + $(this).attr('data-contenteditable')
            var field = document.getElementById(content_id)
            $(field).removeAttr('disabled');

          })

          var options = {
          url: "/static/jsons/world_universities_and_domains.json",
          getValue: "name",
          requestDelay: 200,
          template: {
          type: "description",
          fields: {
              description: "country"
              },
          },
          list: {
              maxNumberOfElements: 7,
              showAnimation: {
              type: "fade", //normal|slide|fade
              time: 300,
              callback: function() {}
              },
              hideAnimation: {
              type: "fade", //normal|slide|fade
              time: 300,
              callback: function() {}
              },
              match: {
                  enabled: true
              }
          },
            theme: "square"
          };

        $("#id_university").easyAutocomplete(options);
        
        $('.easy-autocomplete').ready( function () {
          $('div.easy-autocomplete').removeAttr('style')
          $('div').removeClass('easy-autocomplete');
        })

        $('.menu-link').on('click', function () {
          window.location = $(this).attr('data-url');
        })

        $(document).on('change','.profile-privacy-form input[type="radio"]', function (){
          var form = $(this).closest('form')
          $.ajax({
                  url: form.attr("data-url"),
                  type: 'POST',
                  dataType:'json',
                  data: $(this).closest('form').serialize(),
                  success: function(data){
                      
                    if(data.update_ranking){
                      $('#ranking-form-ctr').html(data.ranking_form)
                    }
                      
                  },
            });
        })

        $(document).on('change','.search-securtiy-form input[type="radio"]', function (){
          var form = $(this).closest('form')
          $.ajax({
                  url: form.attr("data-url"),
                  type: 'POST',
                  dataType:'json',
                  data: $(this).closest('form').serialize(),
                  success: function(data){
                      
                    if(data.update_search_settings){
                      $('#st-form-ctr').html(data.search_settings_form)
                    }
                      
                  },
            });
        })

        $(document).on('change','.notifications-settings-form input[type="radio"]', function (){
          var form = $(this).closest('form')
          $.ajax({
                  url: form.attr("data-url"),
                  type: 'POST',
                  dataType:'json',
                  data: $(this).closest('form').serialize(),
                  success: function(data){
                      
                    if(data.update_notifications_settings){
                      $('#ns-form-ctr').html(data.notifications_form)
                    }
                      
                  },
            });
        })

      })
      
  </script>
</body>
</html>